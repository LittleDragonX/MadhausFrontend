<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
	<title>play_waitattendinfo_body</title>
	<link rel="stylesheet" type="text/css" href="../../css/Hui.css">
	<style type="text/css">
		#list1 {
			-webkit-box-shadow: 0 0 10px rgba(133, 146, 146, .5);
			-moz-box-shadow: 0 0 10px rgba(133, 146, 146, .5);
			box-shadow: 0 0 10px rgba(133, 146, 146, .5);
			margin: 10px 10px 5px 10px;
		}

		#list2 {
			-webkit-box-shadow: 0 0 10px rgba(133, 146, 146, .5);
			-moz-box-shadow: 0 0 10px rgba(133, 146, 146, .5);
			box-shadow: 0 0 10px rgba(133, 146, 146, .5);
			margin: 10px 10px 5px 10px;
		}

		#button1 {
			border-color: #FFF;
			background-color: #FFF;
			color: #2A2A48;
		}

		#button1:active {
			background-color: #f4f5f9;
			color: #2A2A48;
		}

		#button2 {
			background-color: #FF8453;
		}

		#button2:active {
			background-color: #ff5440;
			color: #FFF;
		}
	</style>
</head>

<body>
	<div id="activeDetail" style="display:none;">
	</div>

	<script id="tpl_activeDetail" type="text/html">
		<div id="list1" class="H-border-radius3-px H-theme-background-color-white  H-border-radius-5">
			<div class="H-padding-10 H-padding-vertical-top-15 H-theme-font-color-999 H-font-size-14 H-flexbox-vertical H-text-horizontal-left H-box-sizing-border-box H-text-align-center ">
				<span class="H-display-block H-flex-item H-font-size-18" style="color: #2A2A48;">报名详情</span>
				<span class="H-display-block H-flex-item H-border-radius-15 H-margin-vertical-top-5" style="width:35px;height: 6px;background-color: #FF732E; margin-left: auto; margin-right: auto;"></span>
			</div>
			<div class="H-flexbox-horizontal">
				<div class="H-flex-item H-padding-10">
					<div class="H-font-size-16 H-theme-font-color-black H-text-show-row-1 H-margin-vertical-top-5 H-opacity-1-half">
						姓名: [:=list.cu_username:]
					</div>
					<div class="H-font-size-16 H-theme-font-color-black H-text-show-row-1 H-margin-vertical-top-5 H-opacity-1-half">
						联系手机: [:=list.contact_way:]
					</div>
					<div class="H-font-size-16 H-theme-font-color-black H-text-show-row-1 H-margin-vertical-top-5 H-opacity-1-half">
						报名人数: [:=list.get_join_person_number:]人
					</div>
				</div>
			</div>
			<div class="H-text-align-right H-font-size-16 H-theme-font-color-999 H-padding-vertical-top-8">
				<hr style="height:1px;border:none;border-top:1px dashed #DEDEDE;" />
				<span style="color: #31304C;">报名费合计：</span>
				<span class="H-font-size-22 H-padding-horizontal-right-12" style="color: #FC3337;">￥[:=list.get_join_person_number*list.fee:]</span>
			</div>
			<div class="H-font-size-13 H-theme-font-color-black H-text-show-row-1 H-margin-vertical-top-5 H-opacity-1-half H-text-align-right H-padding-horizontal-right-12">
				确定参加时间: [:=list.start_time.replace('T',' '):]
			</div>
			<!-- <div class="H-font-size-13 H-theme-font-color-black H-text-show-row-1 H-opacity-1-half H-text-align-right H-padding-horizontal-right-12">
				订单号: 33267291804243069
			</div> -->
			<div class="H-font-size-13 H-theme-font-color-black H-text-show-row-1 H-opacity-1-half H-text-align-right H-padding-horizontal-right-12 H-padding-vertical-bottom-12">
				创建时间: [:=list.create_time.replace('T',' ').split('.')[0]:]
			</div>
		</div>
		<div id="list2" class="H-border-radius3-px H-theme-background-color-white  H-border-radius-5">
			<div class="H-padding-10 H-padding-vertical-top-15 H-theme-font-color-999 H-font-size-14 H-flexbox-vertical H-text-horizontal-left H-box-sizing-border-box H-text-align-center ">
				<span class="H-display-block H-flex-item H-font-size-18" style="color: #2A2A48;">活动信息</span>
				<span class="H-display-block H-flex-item H-border-radius-15 H-margin-vertical-top-5" style="width:35px;height: 6px;background-color: #FF732E; margin-left: auto; margin-right: auto;"></span>
			</div>
			<div class="H-flexbox-horizontal H-padding-vertical-bottom-8  H-border-vertical-bottom-after">
				<div class="H-flex-item H-padding-10">
					<div class="H-font-size-16 H-theme-font-color-black H-text-show-row-1 H-margin-vertical-top-5 H-opacity-1-half">
						时间: [:=list.start_time.replace('T',' '):]开始
					</div>
					<div class="H-font-size-16 H-theme-font-color-black H-text-show-row-2 H-margin-vertical-top-5 H-opacity-1-half">
						地点: [:=list.location:]
					</div>
					<div class="H-font-size-16 H-theme-font-color-black H-text-show-row-1 H-margin-vertical-top-5 H-opacity-1-half">
						报名人数: 已报名[:=list.get_join_person_number:]人/限[:=list.people_quota_limit:]人报名
					</div>
				</div>
			</div>
			<div class="H-text-align-center H-font-size-14 H-theme-font-color-999">
				<button id="button1" onclick="callPhone('[:=list.contact_way:]')" tapmode="" class="H-button H-font-size-16 H-outline-none H-theme-background-color-transparent H-padding-vertical-both-8 H-padding-horizontal-both-20 H-theme-font-color4 H-theme-border-color4  H-width-100-percent H-iconfont H-icon-phone H-vertical-middle"
								style="border: 1px solid #FFF;">
						电话咨询
					</button>
			</div>
		</div>
		<div style="height: 50px;"></div>
		<!-- <div class="H-width-100-percent H-height-50 H-theme-background-color-ccc H-center-all H-theme-font-color-white" style="position: fixed; bottom: 0;">
			[:=list.str:]
		</div> -->
		<div class="H-width-100-percent H-border-vertical-top-after" style="position: fixed; bottom: 0;z-index:100000;">
			[:if(list.status==1){:]
			<button onclick="closeOrder()" tapmode="" id="button1" class="H-button H-font-size-18 H-outline-none H-padding-vertical-both-10 H-padding-horizontal-both-20 H-theme-background-color-white H-theme-font-color-white" style="border: 1px solid #FFF; width: 50%; float: left;">
						取消订单
				</button>
			<button onclick="orderPay()" tapmode="" id="button2" class="H-button H-width-50 H-font-size-18 H-outline-none H-padding-vertical-both-10 H-padding-horizontal-both-20 H-theme-font-color-white" style="border: 1px solid #FF8453;width: 50%; float: left;">
						去付款
				</button> [:}else if(list.status==2){:]
			<button onclick="doOrder()" tapmode="" id="button2" class="H-button H-font-size-18 H-outline-none H-padding-vertical-both-10 H-padding-horizontal-both-20 H-theme-font-color-white" style="border: 1px solid #FF8453;width: 100%;">
						完成活动
				</button> [:}else{:]
			<button id="button3"  class="H-button H-font-size-18 H-outline-none H-padding-vertical-both-10 H-padding-horizontal-both-20 H-theme-font-color-white H-theme-background-color-ccc" style="border: 1px solid #ccc;width: 100%;">
						您已成功参加
				</button> [:}:]
		</div>
	</script>
	<script src="../../script/api.js" type="text/javascript"></script>
	<script src="../../script/H.js" type="text/javascript"></script>
	<script src="../../script/setting.js" type="text/javascript"></script>
	<script src="../../script/zepto.min.js" type="text/javascript"></script>
	<script>
		apiready = function() {
			initDatas();
		};

		function callPhone(phone) {
			api.call({
				type: 'tel_prompt',
				number: phone
			});
		};

		function initDatas() {
			var url = window.server + '/fengwans/' + api.pageParam.id + '/';
			api.ajax({
				url: url,
				method: 'get',
				headers: {
					"X-CSRFToken": $api.getStorage("userInfo").token
				}
			}, function(ret, err) {
				log(ret, true);
				if (ret) {
					ret.status = api.pageParam.status;
					log(ret, true);
					var html = H.tppl(H.D('#tpl_activeDetail').innerHTML, {
						list: ret
					});
					$("#activeDetail").html(html).fadeIn();
					api.parseTapmode();
				} else {
					H.toast(JSON.stringify(err));
				}
			});
		};
		function closeOrder(){
			H.toastTip('已取消订单',1000);
			setTimeout(function(){
				api.closeWin();
			},1000);
		};
		function orderPay(){
			openOrder('123456');
		};
		function openOrder(orderId){
			H.openFrame('play_activity_orderPay', 'play_activity_orderPay.html', {
				orderId:orderId
			}, {
				rect : {
					x : 0,
					y : 0,
					w : 'auto',
					h : 'auto'
				},
				bounces : false,
				animation : {
					type : "fade",
					duration : 0
				}
			});
		};
		function doOrder(){
			$('#button2').html('您已完成活动')
			$('#button2').css({'background-color':'#ccc','border-color':'#ccc'});
			H.toastTip('已完成活动',1000);
			setTimeout(function(){
				api.closeWin();
			},1000);
		};
		function setStatus(id,status) {
				var msg = ['加精成功', '删除成功', '已设为黑名单'];
				var url = '/fengliaos/' + id + '/';
				var data = {
					status: status
				};
				ajaxs(url, 'PATCH', data, true, function(ret) {

				}, function(ret, err) {
					log(ret, true);
					log(err, true);
					if(ret){
						H.toastTip(msg[status-1]);
					}else{
						H.toastErr('操作失败');
					}
				});
		};
	</script>
</body>

</html>
