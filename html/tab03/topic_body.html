<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>话题详情</title>
    <link href="../../css/Hui.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="http://at.alicdn.com/t/font_354149_a6vmvwdw4m927qfr.css">
    <style type="text/css">
        .userDiv {
            width: 30px;
            height: 30px;
            position: absolute;
            border: 1px solid rgba(230, 230, 230, 0.47);
        }

        .userImg {
            width: 30px;
            height: 30px;
        }

        .vux-masker-box {
            position: relative;
        }

        .m-img {
            padding-bottom: 50%;
            display: block;
            position: relative;
            max-width: 100%;
            background-size: cover;
            background-position: center center;
            cursor: pointer;
            /*border-radius: 2px;*/
        }

        .vux-masker {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            border-radius: inherit;
        }

        .m-title {
            color: #fff;
            text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
            font-weight: 500;
            font-size: 16px;
            position: absolute;
            left: 0;
            right: 0;
            width: 100%;
            text-align: right;
            bottom: 2px;
            /*padding-left: 10px;
                 -webkit-transform: translateY(-50%);
                 transform: translateY(-50%);*/
        }
    </style>
</head>

<body>
    <div id="itemDetail" class="H-theme-background-color-white H-display-none">
        <div class="H-flexbox-horizontal H-box-sizing-border-box H-clear-both H-padding-horizontal-both-10 H-padding-vertical-both-8">
            <div style="width:45px;height:45px;">
                <img src="../../image/userImg/user03.jpg" onerror="this.src='../../image/userImg/nouser.png'" class="H-width-100-percent H-height-100-percent H-display-block H-border-radius-circle H-border-both">
            </div>
            <div class="H-flex-item H-padding-horizontal-both-10 H-vertical-middle H-overflow-hidden">
                <div class="H-width-100-percent">
                    <span class="H-display-block H-font-size-15 H-theme-font-color4 H-text-show-row-1">海阔天空</span>
                    <div class="H-theme-font-color-999 H-font-size-13 H-text-show-row-1 H-padding-vertical-top-2">
                        10分钟前
                    </div>
                </div>
            </div>
            <div class="H-font-size-12 H-theme-font-color-999 white-space-nowrap H-center-all">
                <span class="H-font-size-14 H-flex-item H-center-all">
                <i class="H-iconfont H-icon-ding-null H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5">
                </i>
                <label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle">
                    3
                </label>
            </span>
            </div>
        </div>
        <div class="H-theme-font-color-333 H-padding-horizontal-both-10 H-margin-vertical-top-10 H-font-size-15" onclick="openDetail(0)" tapmode="">
            如果你无法简洁的表达你的想法，那说明你还不够了解它。
        </div>
        <div class="H-theme-font-color-666 H-text-show-row-2 H-padding-horizontal-both-10 H-font-size-14 H-margin-vertical-both-10" onclick="openDetail(1)" tapmode="">
            如果你无法简洁的表达你的想法，那说明你还不够了解它。如果你无法简洁的表达你的想法，那说明你还不够了解它。
        </div>
        <div class="H-theme-background-color-white H-clear-both H-width-100-percent H-display-table H-box-sizing-border-box H-padding-horizontal-left-10">
            <div class="H-display-table-cell H-float-left H-box-sizing-border-box H-width-avg-1 H-padding-horizontal-right-10 H-margin-vertical-bottom-10">
                <img src="../../image/userImg/bg03.png" class="H-width-100-percent H-display-block" alt="" title="" />
            </div>
        </div>
    </div>
    <div class="H-padding-vertical-bottom-10"></div>
    <div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-vertical-middle">
        <div class="H-padding-horizontal-left-10 H-font-size-16 H-padding-vertical-both-10 H-theme-font-color-444">
            评论
        </div>
        <div class="H-flex-item">
            <span class="H-display-block H-font-size-16 H-margin-horizontal-both-5 H-theme-font-color-999"></span>
        </div>
        <div onclick="goComment()" tapmode="">
            <!--<span class="H-icon H-display-block H-margin-horizontal-right-5">-->
            <!---->
            <!--</span>-->
            <span class="H-display-block H-font-size-15 H-margin-horizontal-right-10 H-vertical-middle color">
            <i class="H-iconfont icon-huodongxiangqing-pinglun H-font-size-18 H-margin-horizontal-right-3 color"></i>参与评论
        </span>
        </div>
    </div>
    <div id="commentList" class="H-display-none">
        <div class="H-flexbox-horizontal H-box-sizing-border-box H-theme-background-color-white H-clear-both H-padding-horizontal-both-10 H-padding-vertical-both-8 H-border-vertical-top-after">
            <div style="width:40px;height:40px;">
                <img src="../../image/userImg/user03.jpg" onerror="this.src='../../image/userImg/nouser.png'" class="H-width-100-percent H-height-100-percent H-display-block H-border-radius-circle H-border-both">
            </div>
            <div class="H-flex-item H-flexbox-vertical H-padding-horizontal-left-10">
                <div class="H-flexbox-horizontal H-width-100-percent">
                    <div class="H-flex-item">
                        <strong class="H-font-weight-normal H-display-block H-font-size-15 H-text-show-row-1" style="color:#FF7C47;">海阔天空</strong>
                        <div class="H-theme-font-color-999 H-font-size-12 H-text-show-row-1">
                            2017-07-11 11:50
                        </div>
                    </div>
                    <div class="H-font-size-12 H-theme-font-color-999 H-center-all">
                        <span class="H-font-size-14 H-flex-item H-center-all"><i
                            class="H-iconfont H-icon-ding-null H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label
                            class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle">3</label></span>
                    </div>
                </div>
                <div class="H-font-size-15 H-padding-vertical-top-5 H-theme-font-color-666">
                    希望大家多支持！
                </div>
            </div>
        </div>
        <div class="H-flexbox-horizontal H-box-sizing-border-box H-theme-background-color-white H-clear-both H-padding-horizontal-both-10 H-padding-vertical-both-8 H-border-vertical-top-after">
            <div style="width:40px;height:40px;"><img src="../../image/userImg/user04.jpg" class="H-width-100-percent H-height-100-percent H-display-block H-border-radius-circle H-border-both">
            </div>
            <div class="H-flex-item H-flexbox-vertical H-padding-horizontal-left-10">
                <div class="H-flexbox-horizontal H-width-100-percent">
                    <div class="H-flex-item">
                        <strong class="H-font-weight-normal H-display-block H-font-size-15 H-text-show-row-1" style="color:#FF7C47;">清水芙蓉</strong>
                        <div class="H-theme-font-color-999 H-font-size-12 H-text-show-row-1">
                            2017-07-11 12:50
                        </div>
                    </div>
                    <div class="H-font-size-12 H-theme-font-color-999 H-center-all">
                        <span class="H-font-size-14 H-flex-item H-center-all"><i
                            class="H-iconfont H-icon-ding-null H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label
                            class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle">12</label></span>
                    </div>
                </div>
                <div class="H-font-size-15 H-padding-vertical-top-5 H-theme-font-color-666">
                    赞赞赞！
                </div>
            </div>
        </div>
    </div>
    <script id="tpl_itemDetail" type="text/html">
        <div class="H-flexbox-horizontal H-box-sizing-border-box H-clear-both H-padding-horizontal-both-10 H-padding-vertical-both-8">
            <div style="width:45px;height:45px;">
                <img src="[:=list.user_avatar+'?imageView2/1/w/200/h/200/interlace/0/q/100':]" onerror="this.src='../../image/userImg/nouser.png'" class="H-width-100-percent H-height-100-percent H-display-block H-border-radius-circle H-border-both">
            </div>
            <div class="H-flex-item H-padding-horizontal-both-10 H-vertical-middle H-overflow-hidden">
                <div class="H-width-100-percent">
                    <span class="H-display-block H-font-size-15 color H-text-show-row-1">[:=list.user_nickname:]</span>
                    <div class="H-theme-font-color-999 H-font-size-13 H-text-show-row-1 H-padding-vertical-top-2">
                        [:=(list.create_time).replace('T',' ').split('.')[0]:]
                    </div>
                </div>
            </div>
            [:if(list.permission==1002){:]
            <div onclick="showManage('[:=list.id:]')" tapmode="" class="H-font-size-12 H-theme-font-color-999 white-space-nowrap H-center-all">
                <span class="H-font-size-14 H-flex-item H-center-all"><i
                    class="H-iconfont H-icon-arrow-down H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i></span>
            </div>
            [:}:]
        </div>
        <div class="H-theme-font-color-333 H-padding-horizontal-both-10 H-margin-vertical-top-10 H-font-size-18 ">
            <strong>[:=list.title:]</strong>
        </div>
        [:if(list.create_user==list.uid){:]
        <div onclick="removeItem()" tapmode="" class="H-theme-font-color4 H-padding-horizontal-both-10 H-margin-vertical-top-10 H-font-size-15">
            删除本帖
        </div>
        [:}:]
        <div class="H-theme-font-color-666 H-text-show-row-2 H-padding-horizontal-both-10 H-font-size-14 H-margin-vertical-both-10">
            [:=list.content:]
        </div>
        <div class="H-theme-background-color-white H-clear-both H-width-100-percent H-display-table H-box-sizing-border-box H-padding-horizontal-left-10">
            [:if(list.ap_article.length>0){:] [: for (var i=0;i
            <list.ap_article.length;i++) { :] <div class="H-display-table-cell H-float-left H-box-sizing-border-box H-width-avg-1 H-padding-horizontal-right-10 H-margin-vertical-bottom-10">
                <img src="[:=list.ap_article[i].pic:]" class="H-width-100-percent H-display-block" alt="" title="" />
        </div>
        [:}}:]
        </div>
    </script>
    <script id="tpl_commentList" type="text/html">
        [:if(list.length>0){:] [: for (var i=0;i
        <list.length;i++) { :] <div class="H-flexbox-horizontal H-box-sizing-border-box H-theme-background-color-white H-clear-both H-padding-horizontal-both-10 H-padding-vertical-both-8 H-border-vertical-top-after">
            <div style="width:40px;height:40px;"><img src="[:=list[i].user_avatar+'?imageView2/1/w/200/h/200/interlace/0/q/100':]" onerror="this.src='../../image/userImg/nouser.png'" class="H-width-100-percent H-height-100-percent H-display-block H-border-radius-circle H-border-both">
            </div>
            <div class="H-flex-item H-flexbox-vertical H-padding-horizontal-left-10">
                <div class="H-flexbox-horizontal H-width-100-percent">
                    <div class="H-flex-item">
                        <strong class="H-font-weight-normal H-display-block H-font-size-15 H-text-show-row-1 color">[:=list[i].user_name:]</strong>
                        <div class="H-theme-font-color-999 H-font-size-12 H-text-show-row-1">
                            [:=((list[i].create_time).split('.')[0]).replace('T',' '):]
                        </div>
                    </div>
                    <!--<div class="H-font-size-12 H-theme-font-color-999 H-center-all">
        <span class="H-font-size-14 H-flex-item H-center-all"><i class="H-iconfont H-icon-ding-null H-theme-font-color-ccc H-font-size-18 H-margin-horizontal-right-5"></i><label class="H-display-inline-block H-theme-font-color-ccc H-vertical-middle">12</label></span>
        </div>-->
                </div>
                <div class="H-font-size-15 H-padding-vertical-top-5 H-theme-font-color-666">
                    [:=list[i].content:]
                </div>
            </div>
            </div>
            [:}}else{:]
            <div class="H-padding-vertical-both-20 H-theme-font-color-999 H-font-size-16 H-center-all">暂无数据</div>
            [:}:]
    </script>
    <script src="../../script/H.js" type="text/javascript"></script>
    <script src="../../script/setting.js" type="text/javascript"></script>
    <script src="../../script/zepto.min.js" type="text/javascript"></script>
    <script src="../../script/api.js"></script>
    <script type="text/javascript">
        var userId = null,
            aid = null;
        apiready = function() {
            initDatas();
            initComment();
        };
        //评论详情
        function initDatas() {
            var url = '/fengliaos/' + api.pageParam.id + '/';
            ajaxs(url, 'get', null, false, function(ret) {

            }, function(ret, err) {
                if (ret) {
                    var userInfo = $api.getStorage("userInfo");
                    ret.uid = userInfo ? userInfo.user.id : 0;
                    ret.permission = userInfo ? userInfo.user.permission : 0;
                    var html = H.tppl(H.D('#tpl_itemDetail').innerHTML, {
                        list: ret
                    });
                    $("#itemDetail").html(html).fadeIn();
                    aid = ret.id
                    log(aid);
                    api.parseTapmode();
                } else {
                    H.toast(JSON.stringify(err));
                }
            });
        };
        //评论列表
        function initComment() {
            var url = '/fengliao/reply/home/';
            var data = {
                fengliao_id: api.pageParam.id
            };
            ajaxs(url, 'get', data, false, function(ret) {

            }, function(ret, err) {
                if (ret) {
                    var html = H.tppl(H.D('#tpl_commentList').innerHTML, {
                        list: ret.data
                    });
                    $("#commentList").html(html).fadeIn();
                    api.parseTapmode();
                } else {
                    H.toast(JSON.stringify(err));
                }
            });
        };

        function removeItem() {
            H.toast('已成功删除本帖');
            setTimeout(function() {
                api.closeWin();
            }, 1000);
        };

        function showManage(id) {
            H.actionSheet(function(ret, err) {
                if (ret.buttonIndex == 1) {
                    H.toast('已加精');
                    // jiajing(api.pageParam.id, id);
                    // initData();
                } else if (ret.buttonIndex == 2) {
                    H.toast('已成功删除');
                    // del(api.pageParam.id, id);
                    // initData();
                } else if (ret.buttonIndex == 3) {
                    H.toast('已加入黑名单');
                    // heimingdan(api.pageParam.id, id);
                    // initData();
                }
            }, null, ['加精', '删除', '黑名单']);
        };

        function showDetailMore(obj) {
            var isShow = $(obj).attr('data-showOpen');
            if (isShow == "false") {
                $('#details').removeClass("H-text-show-row-3");
                $(obj).find('.H-iconfont').removeClass("H-icon-arrow-down").addClass("H-icon-arrow-up");
                $(obj).attr('data-showOpen', 'true');
            } else {
                $('#details').addClass("H-text-show-row-3");
                $(obj).find('.H-iconfont').removeClass("H-icon-arrow-up").addClass("H-icon-arrow-down");
                $(obj).attr('data-showOpen', 'false');
            }
        };

        function openEnrol() {
            H.openFrame('activity_enrol', 'activity_enrol.html', {}, {
                rect: {
                    x: 0,
                    y: 0,
                    w: 'auto',
                    h: 'auto'
                },
                bounces: false,
                animation: {
                    type: "fade",
                    duration: 0
                }
            });
        };
        function openWins(title, name, url, data) {
          H.openWin('base_head_' + name, 'widget://html/comPages/base_head.html', {
            title: title,
            name: name,
            url: url,
            data: data
          });
        };
        //跳转评论页面
        function goComment() {
            var userInfo = $api.getStorage("userInfo");
            if (userInfo) {
                H.openFrame('topic_comment', 'topic_comment.html', {
                    aid: aid,
                    userId: userId,
                    uid: 1
                }, {
                    rect: {
                        x: 0,
                        y: 0,
                        w: 'auto',
                        h: 'auto'
                    },
                    bounces: false,
                    animation: {
                        type: "fade",
                        duration: 0
                    }
                });
            } else {
                api.toast({
                    msg: '请先登录',
                    duration: 2000,
                    location: 'middle'
                });
                openWins('', 'user_login_body', '../user/user_login_body.html');
                return;
            }
        }
        //点赞功能
        function clickZan(pid) {
            var url = '/fengliao/party/praise/article/';
            var data = {
                article_id: api.pageParam.id,
                praise: pid == 0 ? 1 : 0
            };
            var token = $api.getStorage("userInfo");
            ajax(url, 'post', data, token, function(ret) {
                initData();
            }, function(ret, err) {
                log(ret, true);
                log(err, true);
            })
        };

        function initTupian() {
            var url = '/fengliao/pic/';
            var data = {
                article: api.pageParam.id,
                pic: null,
                create_user: null
            };
            var token = $api.getStorage("userInfo");
            ajax(url, 'post', data, token, function(ret) {
                log(ret);
            }, function(ret, err) {

            })
        };
    </script>
</body>

</html>
