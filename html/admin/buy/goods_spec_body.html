<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
	<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
	<title>分类 - 疯玩</title>
	<link href="../../../css/Hui.css" rel="stylesheet" type="text/css" />
	<style type="text/css">
		.H-timeline,
		.H-timeline-dot,
		html,
		body {
			background: #fff;
		}

		.H-width-avg-4 {
			padding: 0 0 15px 0;
		}

		.H-theme-border-color-ccc {
			border: 1px solid #f4f5f6;
			background-color: #f4f5f6;
		}

		.H-width-avg-4 .H-flex-item {
			max-width: 68px;
			text-align: center;
		}
	</style>
</head>

<body>
	<div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-vertical-middle H-padding-horizontal-left-10" style="box-shadow: 0 1px 6px #fff;height:42px;">
		<div class="H-flex-item H-font-size-16" style="padding: 9px 0px;">
			已有商品规格
		</div>
	</div>
	<div id="indexCate" style="display:none;">
		<!-- <div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">尺码</div>
			<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">¥8.8</div>
			<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">100</div>
			<span class="H-icon H-padding-horizontal-right-12 H-display-block"><i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i></span>
		</div> -->
	</div>
	<div style="height: 48px;"></div>
	<div class="H-flexbox-horizontal H-box-sizing-border-box" style="position: fixed;bottom:0px;z-index: 10000;">
		<div tapmode="" onclick="btnSubmit()" class="H-flex-item H-center-all H-padding-vertical-both-12 H-font-size-16 H-theme-font-color-white" style="background-color:#ff7c48;">
			确定
		</div>
	</div>
	<script id="tpl_itemList" type="text/html">
		[:if(list.length>0){:]
		[:for(var i=0;i<list.length;i++){:]
		<div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle">
			<span onclick="removeItem('[:=list[i].id:]','[:=list[i].is_default:]')" tapmode="" class="H-icon H-display-block H-margin-horizontal-left-10"><i class="H-iconfont H-icon-rubbish H-font-size-22 H-vertical-middle H-theme-font-color1"></i></span>
			<div onclick="openDetail('[:=list[i].id:]')" tapmode="" class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">[:=list[i].standard:]</div>
			<div onclick="openDetail('[:=list[i].id:]')" tapmode="" class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">¥[:=list[i].fee:]</div>
			<div class="H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">
				[:if(list[i].is_default==1){:]
					<button onclick="setChecked('[:=list[i].id:]','[:=list[i].is_default:]')" tapmode="" class="H-buttons H-font-size-13 H-outline-none H-padding-vertical-both-5 H-padding-horizontal-both-5 H-theme-background-color1 H-theme-font-color-white H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-3">已为默认</button>
				[:}else{:]
					<button onclick="setChecked('[:=list[i].id:]')" tapmode="" class="H-buttons H-font-size-13 H-outline-none H-theme-background-color-transparent H-padding-vertical-both-5 H-padding-horizontal-both-5 H-theme-font-color1 H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click H-border-radius-3">设为默认</button>
				[:}:]
				</div>
			<span onclick="openDetail('[:=list[i].id:]')" tapmode="" class="H-icon H-padding-horizontal-both-12 H-display-block"><i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i></span>
		</div>
		[:}}else{:]
			<div class="H-padding-vertical-both-20 H-theme-font-color-999 H-font-size-16 H-center-all">暂无数据</div>
		[:}:]
	</script>
	<script id="tpl_indexCate" type="text/html">
		<div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle">
			<span class="H-icon H-display-block H-margin-horizontal-left-10"><i class="H-iconfont H-icon-rubbish H-font-size-22 H-vertical-middle H-theme-font-color1"></i></span>
			<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">[:=list.name:]</div>
			<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">¥[:=list.price:]</div>
			<div class="H-padding-horizontal-both-10 H-font-size-16 H-padding-vertical-both-12">
				<input type="radio" name="v" checked="checked" class="H-radio H-radio-null H-vertical-align-middle H-font-size-18 H-theme-font-color1 H-border-radius-circle"><label class="H-font-size-14">默认</label></div>
			<span class="H-icon H-padding-horizontal-right-12 H-display-block"><i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i></span>
		</div>
	</script>
	<script type="text/javascript" src="../../../script/api.js"></script>
	<script src="../../../script/H.js" type="text/javascript"></script>
	<script src="../../../script/setting.js" type="text/javascript"></script>
	<script src="../../../script/zepto.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		H.ready(function() {
			initDatas();
		});
		function openDetail(id) {
			H.openWin('base_head_goods_spec_edit_body', 'widget://html/comPages/detail_head.html', {
				title: '编辑规格',
				name: 'goods_spec_edit_body',
				url: '../admin/buy/goods_spec_edit_body.html',
				id: id
			});
		};
		function removeItem(id,isDefault){
			if(isDefault==1){
				return H.toast('不能删除默认项');
			}
			var url = '/fenggou/product/spec/'+id+'/';
			var data = {
				is_default:1
			};
			ajaxs(url, 'DELETE', data, true, function(ret){
				log(ret,true);
				if(ret.id){
					H.toast('已成功删除该项');
					initDatas();
					api.sendEvent({
					    name: 'loadGoodsEditData',
					    extra: {
					        key1: '1'
					    }
					});
				}else{
					H.toast('操作失败，请重试')
				}
			}, function(ret,err){
				log(err,true)
			});
		};
		function setChecked(id,isDefault){
			if(isDefault==1){
				return ;
			}
			var url = '/fenggou/product/spec/'+id+'/';
			var data = {
				is_default:1
			};
			ajaxs(url, 'PATCH', data, true, function(ret){
				log(ret,true);
				if(ret.id){
					initDatas();
					api.sendEvent({
					    name: 'loadGoodsEditData',
					    extra: {
					        key1: '1'
					    }
					});
				}else{
					H.toast('操作失败，请重试')
				}
			}, function(ret,err){
				log(err,true)
			});
		};
		function initData(name, price, num) {
			var html = H.tppl(H.D('#tpl_indexCate').innerHTML, {
				list: {
					name: name,
					price: price,
					num: num
				}
			});
			$('#indexCate').append(html).fadeIn(300);
			api.parseTapmode();
		};
		function initDatas() {
			log(api.pageParam.id)
			var url = '/fenggou/product/spec/sign/';
			var data = {
				pro_id:api.pageParam.id
			};
			ajaxs(url, 'get', data, true, function(ret){
				log(ret,true);
				if(ret.success){
					var html = H.tppl(H.D('#tpl_itemList').innerHTML, {
						list : ret.data
					});
					$("#indexCate").html(html).fadeIn(300);
					api.parseTapmode();
				}else{
					H.toast(ret.msg)
				}
			}, function(ret,err){
			});
		};
		function btnSubmit(){
			api.closeWin();
		};
	</script>
</body>

</html>
