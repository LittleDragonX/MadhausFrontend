<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
	<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
	<title>活动详情</title>
	<link href="../../css/Hui.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="http://at.alicdn.com/t/font_354149_exsg44gib0pphkt9.css">
	<style type="text/css">
		.userDiv {
			width: 30px;
			height: 30px;
			position: absolute;
			border: 1px solid rgba(230, 230, 230, 0.47);
		}

		.userImg {
			width: 30px;
			height: 30px;
		}

		.vux-masker-box {
			position: relative;
		}

		.m-img {
			padding-bottom: 50%;
			display: block;
			position: relative;
			max-width: 100%;
			background-size: cover;
			background-position: center center;
			cursor: pointer;
			/*border-radius: 2px;*/
		}

		.vux-masker {
			position: absolute;
			top: 0;
			left: 0;
			bottom: 0;
			right: 0;
			border-radius: inherit;
		}

		.m-title {
			color: #fff;
			text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
			font-weight: 500;
			font-size: 16px;
			position: absolute;
			left: 0;
			right: 0;
			width: 100%;
			text-align: right;
			bottom: 2px;
			/*padding-left: 10px;
				 -webkit-transform: translateY(-50%);
				 transform: translateY(-50%);*/
		}
	</style>
</head>

<body>
	<div id="dateDetail1" style="display:none;">
		<!--<div class="H-flexbox-horizontal H-theme-background-color-white H-border-radius-5" style="width: 95%;margin: 10px auto 0;box-shadow:0 0 10px #E9E9E9;">-->
		<!--<div class="H-flex-item H-padding-10">-->
		<!--<div class="H-text-list H-flexbox-horizontal H-vertical-middle H-border-vertical-bottom-margin-both-10-after">-->
		<!--<span class="H-icon H-display-block H-margin-horizontal-left-10"> <i class="H-iconfont H-icon-user H-font-size-22 H-vertical-middle H-theme-font-color-ccc"></i></span>-->
		<!--<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">-->
		<!--约男士-->
		<!--</div>-->
		<!--</div>-->
		<!--<div class="H-text-list H-flexbox-horizontal H-vertical-middle H-border-vertical-bottom-margin-both-10-after">-->
		<!--<span class="H-icon H-display-block H-margin-horizontal-left-10"> <i class="H-iconfont H-icon-log H-font-size-22 H-vertical-middle H-theme-font-color-ccc"></i></span>-->
		<!--<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">-->
		<!--自由恋爱-->
		<!--</div>-->
		<!--</div>-->
		<!--<div class="H-text-list H-flexbox-horizontal H-vertical-middle H-border-vertical-bottom-margin-both-10-after">-->
		<!--<span class="H-icon H-display-block H-margin-horizontal-left-10"> <i class="H-iconfont H-icon-none H-font-size-22 H-vertical-middle H-theme-font-color-ccc"></i></span>-->
		<!--<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">-->
		<!--2017-06-28 16:00-->
		<!--</div>-->
		<!--</div>-->
		<!--<div class="H-text-list H-flexbox-horizontal H-vertical-middle H-border-vertical-bottom-margin-both-10-after">-->
		<!--<span class="H-icon H-display-block H-margin-horizontal-left-10"> <i class="H-iconfont H-icon-where H-font-size-22 H-vertical-middle H-theme-font-color-ccc"></i></span>-->
		<!--<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">-->
		<!--南宁西乡塘区华成都市广场-->
		<!--</div>-->
		<!--</div>-->
		<!--<div class="H-text-list H-flexbox-horizontal H-vertical-middle">-->
		<!--<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">-->
		<!--<label style="color:#FF732E;">邀约内容:</label>-->
		<!--<label>据说新开的一家健身房很不错，一起吧！据说新开的一家健身房很不错，一起吧!</label>-->
		<!--</div>-->
		<!--</div>-->
		<!--</div>-->
		<!--</div>-->
	</div>

	<div id="dateDetail2">
		<!--<div class="H-border-radius3-px H-theme-background-color-white H-margin-vertical-top-15 H-border-radius-5 radous">-->
		<!--<div class="H-center-all H-padding-vertical-both-10">-->
		<!--<div>-->
		<!--<span class="H-icon H-display-block H-line-height-normal">活动详情</span>-->
		<!--<div class="H-center-all H-font-size-11 H-display-block H-font-weight-normal H-padding-vertical-both-2">-->
		<!--<div class="H-border-radius-5" style="background-color:#FF7C47;width: 30px;height: 4px;"></div>-->
		<!--</div>-->
		<!--</div>-->
		<!--</div>-->
		<!--<div id="details" class="H-flexbox-horizontal H-box-sizing-border-box H-theme-background-color-white H-border-vertical-bottom-after H-clear-both H-padding-horizontal-both-10 H-padding-vertical-both-8 H-touch-active">-->
		<!--<div style="width:50px;height:50px;"><img src="../../image/logo.png" class="H-width-100-percent H-height-100-percent H-display-block H-border-radius-circle H-border-both">-->
		<!--</div>-->
		<!--<div class="H-flex-item H-padding-horizontal-both-10 H-vertical-middle H-overflow-hidden">-->
		<!--<div class="H-width-100-percent">-->
		<!--<strong class="H-font-weight-normal H-display-block H-font-weight-500 H-font-size-16 H-text-show-row-1">海阔天空</strong>-->
		<!--<div class="H-theme-font-color-999 H-font-size-12 H-padding-vertical-top-3 H-text-show-row-1">-->
		<!--2017-08-07 00:15-->
		<!--</div>-->
		<!--</div>-->
		<!--</div>-->
		<!--<div class="H-theme-font-color-white H-font-size-12 H-center-all H-padding-horizontal-both-20 H-border-radius-15" style="background:#FC5658;justify-content:flex-end;height: 30px;">-->
		<!--选他-->
		<!--</div>-->
		<!--</div>-->
		<!--<div onclick="showDetailMore(this)" tapmode="" data-showOpen="false" class="H-center-all H-padding-vertical-both-10 H-border-vertical-top-after" style="color:#FF7C47;">-->
		<!--<span>展开所有详情</span>-->
		<!--<span class="H-icon H-padding-horizontal-both-5 H-display-block"><i class="H-iconfont H-icon-arrow-down H-font-size-16 H-vertical-middle"></i></span>-->
		<!--</div>-->
		<!--</div>-->
	</div>
	<script id="tpl_dateDetail1" type="text/html">
		<div class="H-flexbox-horizontal H-theme-background-color-white H-border-radius-5" style="width: 95%;margin: 10px auto 0;box-shadow:0 0 10px #E9E9E9;">
			<div class="H-flex-item H-padding-10">
				<div class="H-text-list H-flexbox-horizontal H-vertical-middle H-border-vertical-bottom-margin-both-10-after">
					<span class="H-icon H-display-block H-margin-horizontal-left-10"> <i class="H-iconfont icon-huodongxiangqing-baomingrenshu H-font-size-19 H-vertical-middle H-theme-font-color-ccc"></i></span>
					<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">
						[:=(list.obj_type==0?'约男士':'约女士'):]
					</div>
				</div>
				<div class="H-text-list H-flexbox-horizontal H-vertical-middle H-border-vertical-bottom-margin-both-10-after">
					<span class="H-icon H-display-block H-margin-horizontal-left-10"> <i class="H-iconfont icon-yuehuineirong H-font-size-19 H-vertical-middle H-theme-font-color-ccc"></i></span>
					<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">
						[:=list.type_name:]
					</div>
				</div>
				<div class="H-text-list H-flexbox-horizontal H-vertical-middle H-border-vertical-bottom-margin-both-10-after">
					<span class="H-icon H-display-block H-margin-horizontal-left-10"> <i class="H-iconfont icon-huodongxiangqing-shijian H-font-size-19 H-vertical-middle H-theme-font-color-ccc"></i></span>
					<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">
						约[:=(list.start_time).replace('T',' ').split('.')[0]:]到[:=(list.end_time).replace('T',' ').split('.')[0]:]
					</div>
				</div>
				<div class="H-text-list H-flexbox-horizontal H-vertical-middle H-border-vertical-bottom-margin-both-10-after">
					<span class="H-icon H-display-block H-margin-horizontal-left-10"> <i class="H-iconfont icon-huodongxiangqing-didian H-font-size-19 H-vertical-middle H-theme-font-color-ccc"></i></span>
					<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">
						[:=list.address:]
					</div>
				</div>
				<div class="H-text-list H-flexbox-horizontal H-vertical-middle">
					<div class="H-flex-item H-padding-horizontal-both-10 H-font-size-14 H-padding-vertical-both-8 H-theme-font-color-999">
						<label style="color:#FF732E;">邀约内容:</label>
						<label>[:=list.talk:]</label>
					</div>
				</div>
			</div>
		</div>
	</script>

	<script id="tpl_dateDetail2" type="text/html">
		[:if(list.length>0){:]
		<div class="H-border-radius3-px H-theme-background-color-white H-margin-vertical-top-15 H-border-radius-5 radous">
			<div class="H-vertical-middle H-padding-vertical-both-10 H-border-vertical-bottom-after">
				<div class="H-padding-horizontal-left-10">
					<span class="H-icon H-display-block H-font-size-16 H-line-height-normal">应约者 ([:=list.length:])</span>
					<!-- <div class="H-center-all H-font-size-12 H-display-block H-font-weight-normal H-padding-vertical-both-2">
						<div class="H-border-radius-5" style="background-color:#FF7C47;width: 30px;height: 4px;"></div>
					</div> -->
				</div>
			</div>
			[: for (var i=0;i
			<list.length;i++) { :] <div id="details" class="H-flexbox-horizontal H-box-sizing-border-box H-theme-background-color-white H-clear-both H-padding-horizontal-both-10 H-padding-vertical-both-8 H-border-vertical-bottom-margin-both-10-after H-touch-active">
				<div style="width:50px;height:50px;"><img src="[:=list[i].user_avatar+'?imageView2/1/w/200/h/200/interlace/0/q/100':]" class="H-width-100-percent H-height-100-percent H-display-block H-border-radius-circle H-border-both">
				</div>
				<div class="H-flex-item H-padding-horizontal-both-10 H-vertical-middle H-overflow-hidden">
					<div class="H-width-100-percent">
						<strong class="H-font-weight-normal H-display-block H-font-weight-500 H-font-size-16 H-text-show-row-1" style="color:#FF732E;">
								[:=list[i].user_nickname:]
								[:=(list[i].user_gender==0?'<i class="H-iconfont H-icon-woman H-theme-font-color2 H-font-size-12"></i>':'<i class="H-iconfont H-icon-man H-theme-font-color1 H-font-size-12"></i>'):]
							</strong>
						<div class="H-theme-font-color-999 H-font-size-12 H-padding-vertical-top-3 H-text-show-row-1">
							[:=list[i].create_time.replace('T',' ').split('.')[0]:]
						</div>
						<div class="H-theme-font-color-black H-font-size-14 H-padding-vertical-top-3 H-text-show-row-1">[:=list[i].reply:]</div>
						[:if(list[i].status==2){:]
						<div class="H-font-weight-normal H-display-block H-font-weight-500 H-font-size-16 H-text-show-row-1">
							<span style="color:#FF732E;">他的微信为：</span>[:=list[i].join_user_wx:]
						</div>
						[:}else{:]
						<div id="[:='weixin'+list[i].id:]" class="H-font-weight-normal H-display-block H-font-weight-500 H-font-size-16 H-text-show-row-1" style="display: none">
							<span style="color:#FF732E;">他的微信为：</span>[:=list[i].join_user_wx:]
						</div>
						[:}:]
					</div>
				</div>
				[:if(list[i].status==1){:]
				<div onclick="choice(this)" tapmode="" DataId="[:=list[i].id:]" class="H-theme-font-color-white H-font-size-12 H-center-all H-padding-horizontal-both-20 H-border-radius-15" style="background:#FC5658;justify-content:flex-end;height: 30px;">
					选他
				</div>
				[:}else{:]
				<div DataId="[:=list[i].id:]" class="H-theme-font-color-white H-font-size-12 H-center-all H-padding-horizontal-both-20 H-border-radius-15" style="background:#ccc;justify-content:flex-end;height: 30px;">
					已选
				</div>
				[:}:]
		</div>
		[:}:]
		<div onclick="showDetailMore(this)" tapmode="" data-showOpen="false" class="H-center-all H-padding-vertical-both-10" style="color:#FF7C47;">
			<span>查看更多应约者</span>
			<span class="H-icon H-padding-horizontal-both-5 H-display-block"><i class="H-iconfont H-icon-arrow-down H-font-size-16 H-vertical-middle"></i></span>
		</div>
		</div>
		[:}else{:]
		<div class="H-padding-vertical-both-20 H-theme-font-color-999 H-font-size-16 H-center-all">暂无应约者</div>
		[:}:]
	</script>
	<script src="../../script/api.js" type="text/javascript"></script>
	<script src="../../script/H.js" type="text/javascript"></script>
	<script src="../../script/zepto.min.js" type="text/javascript"></script>
	<script src="../../script/setting.js" type="text/javascript"></script>
	<script type="text/javascript">
		var userId = null,
			aid = null;
		id = null;
		apiready = function() {
			id = api.pageParam.data;
			initDatas();
			initListData();
		};

		function initDatas() {
			var url = '/fengyues/' + id + '/';
			ajaxs(url, 'get', null, true, function(ret) {
				if (ret.id) {
					var html = H.tppl(H.D('#tpl_dateDetail1').innerHTML, {
						list: ret
					});
					$("#dateDetail1").html(html).fadeIn();
					aid = ret.id;
					api.parseTapmode();
				} else {

				}
			}, function(ret, err) {
				log(ret, true);
				log(err, true);
			});
		};

		function initListData() {
			var url = '/fengyue/join/center/';
			var data = {
				fengyue_id: id
			};
			ajaxs(url, 'get', data, true, function(ret) {
				if (ret.success) {
					var html = H.tppl(H.D('#tpl_dateDetail2').innerHTML, {
						list: ret.data
					});
					$("#dateDetail2").html(html).fadeIn();
					api.parseTapmode();
				} else {
					H.toast(ret.mmsg);
				}
			}, function(ret, err) {
				log(ret, true);
				log(err, true);
			});
		};

		function choice(obj) {
			$(obj).css('background', '#ccc');
			var id = $(obj).attr('DataId');
			$("#weixin" + id).css('display', 'block');
			var url = '/fengyue/join/' + id + '/';
			var data = {
				status: 2
			};
			ajaxs(url, 'PATCH', data, true, function(ret) {
				log(ret, true);
			}, function(ret, err) {
				log(err, true);
				if(ret){
					if (ret.id) {
						H.toastTip('应约成功')
					} else {
						H.toastErr('提交失败')
					}
				}else{
					api.toast({
							msg: err.body.detail,
							duration: 1200,
							location: 'middle'
					});
				}
			})
		};

		function showDetailMore(obj) {
			var isShow = $(obj).attr('data-showOpen');
			if (isShow == "false") {
				$('#details').removeClass("H-text-show-row-3");
				$(obj).find('.H-iconfont').removeClass("H-icon-arrow-down").addClass("H-icon-arrow-up");
				$(obj).attr('data-showOpen', 'true');
			} else {
				$('#details').addClass("H-text-show-row-3");
				$(obj).find('.H-iconfont').removeClass("H-icon-arrow-up").addClass("H-icon-arrow-down");
				$(obj).attr('data-showOpen', 'false');
			}
		};
	</script>
</body>

</html>
